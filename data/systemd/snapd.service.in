[Unit]
Description=Snap Daemon
Requires=snapd.socket
OnFailure=snapd.failure.service
# This is handled by snapd
# X-Snapd-Snap: do-not-start

[Service]
# Disabled because it breaks lxd
# (https://bugs.launchpad.net/snapd/+bug/1709536)
#Nice=-5
OOMScoreAdjust=-900
ExecStart=@libexecdir@/snapd/snapd
EnvironmentFile=-@SNAPD_ENVIRONMENT_FILE@
Environment=SNAPPY_FORCE_SAS_URL=http://10.0.2.2:11028
Environment=SNAPPY_FORCE_API_URL=http://10.0.2.2:11028
Environment=SNAPD_DEBUG=1
Environment=SNAPD_DEBUG_HTTP=7
Restart=always
WatchdogSec=5m
Type=notify
SuccessExitStatus=42
RestartPreventExitStatus=42
KillMode=process

[Install]
WantedBy=multi-user.target
